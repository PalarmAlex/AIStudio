<Window x:Class="AIStudio.Dialogs.AutomatizmLoadDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Загрузка автоматизмов из файла" 
        Height="450" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        PreviewKeyDown="Window_PreviewKeyDown">

  <Window.Resources>
    <Style x:Key="DialogHeaderStyle" TargetType="TextBlock">
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Margin" Value="0,0,0,15"/>
    </Style>

    <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Margin" Value="0,10,0,5"/>
    </Style>

    <Style x:Key="InfoTextStyle" TargetType="TextBlock">
      <Setter Property="Foreground" Value="#FF666666"/>
      <Setter Property="FontStyle" Value="Italic"/>
      <Setter Property="Margin" Value="0,0,0,10"/>
    </Style>
  </Window.Resources>

  <Grid Margin="20">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Заголовок -->
    <TextBlock Grid.Row="0" 
                   Text="Загрузка автоматизмов из файла"
                   Style="{StaticResource DialogHeaderStyle}"/>

    <!-- Информация о файле -->
    <Border Grid.Row="1" 
                BorderBrush="#FFE0E0E0" 
                BorderThickness="1"
                CornerRadius="4"
                Padding="10"
                Background="#FFF9F9F9"
                Margin="0,0,0,15">
      <StackPanel>
        <TextBlock Text="Информация о файле" 
                           FontWeight="SemiBold"
                           Margin="0,0,0,5"/>
        <TextBlock Text="{Binding FilePath, Mode=OneWay}"
                           TextWrapping="Wrap"
                           Style="{StaticResource InfoTextStyle}"/>
      </StackPanel>
    </Border>

    <!-- Выбор базового состояния -->
    <StackPanel Grid.Row="2" Margin="0,0,0,15">
      <TextBlock Text="Базовое состояние агента"
                       Style="{StaticResource SectionHeaderStyle}"/>

      <ComboBox x:Name="BaseStateComboBox"
                      ItemsSource="{Binding BaseStates}"
                      DisplayMemberPath="Value"
                      SelectedValuePath="Key"
                      SelectedValue="{Binding SelectedBaseState}"
                      Height="30"
                      Margin="0,5,0,0"/>
    </StackPanel>

    <!-- Выбор комбинации стилей -->
    <StackPanel Grid.Row="3" Margin="0,0,0,15">
      <TextBlock Text="Комбинация стилей поведения"
                       Style="{StaticResource SectionHeaderStyle}"/>

      <DockPanel Margin="0,5,0,0">
        <ComboBox x:Name="StylesComboBox"
                          ItemsSource="{Binding StyleCombinations}"
                          DisplayMemberPath="DisplayName"
                          SelectedValuePath="StyleIds"
                          SelectedValue="{Binding SelectedStyleIds}"
                          Height="30"
                          DockPanel.Dock="Left"
                          Width="380"/>

        <Button x:Name="GenerateStylesButton"
                        Content="Обновить список"
                        Command="{Binding LoadStylesCommand}"
                        Height="30"
                        Width="120"
                        Margin="10,0,0,0"
                        DockPanel.Dock="Right"/>
      </DockPanel>

      <TextBlock Text="{Binding StylesStatusText}"
                       Style="{StaticResource InfoTextStyle}"
                       Margin="0,5,0,0"
                       TextWrapping="Wrap"/>
    </StackPanel>

    <!-- Превью выбранных параметров -->
    <Border Grid.Row="4" 
                BorderBrush="#FFE0E0E0" 
                BorderThickness="1"
                CornerRadius="4"
                Padding="10"
                Background="#FFF9F9F9"
                Margin="0,0,0,15"
                VerticalAlignment="Top">
      <StackPanel>
        <TextBlock Text="Выбранные параметры" 
                           FontWeight="SemiBold"
                           Margin="0,0,0,10"/>

        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <TextBlock Grid.Row="0" Grid.Column="0" 
                               Text="Базовое состояние:" 
                               Margin="0,0,10,5"/>
          <TextBlock Grid.Row="0" Grid.Column="1" 
                               Text="{Binding SelectedBaseStateDisplay}" 
                               FontWeight="SemiBold"
                               Margin="0,0,0,5"/>

          <TextBlock Grid.Row="1" Grid.Column="0" 
                               Text="Комбинация стилей:" 
                               Margin="0,0,10,5"/>
          <TextBlock Grid.Row="1" Grid.Column="1" 
                               Text="{Binding SelectedStylesDisplay}" 
                               FontWeight="SemiBold"
                               TextWrapping="Wrap"
                               Margin="0,0,0,5"/>
        </Grid>
      </StackPanel>
    </Border>

    <!-- Кнопки -->
    <StackPanel Grid.Row="5" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Margin="0,20,0,0">
      <Button Content="Загрузить" 
                    Command="{Binding LoadCommand}"
                    IsEnabled="{Binding CanLoad}"
                    Height="35" 
                    Width="120"
                    Margin="0,0,10,0"
                    Cursor="Hand"
                    ToolTip="Запустить генерацию автоматизмов с выбранными параметрами"/>

      <Button Content="Отмена" 
                    Command="{Binding CancelCommand}"
                    Height="35" 
                    Width="100"
                    Cursor="Hand"/>
    </StackPanel>
  </Grid>
</Window>