<UserControl x:Class="AIStudio.Pages.AgentPultView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:AIStudio.Pages"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

  <UserControl.Resources>
    <!-- Стиль для названий элементов пульта -->
    <Style x:Key="PropertyNameStyle" TargetType="TextBlock">
      <Setter Property="HorizontalAlignment" Value="Left"/>
      <Setter Property="Margin" Value="0,0,0,5"/>
      <Setter Property="Width" Value="200"/>
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="Bold"/>
    </Style>

    <!-- Стиль для значений элементов пульта -->
    <Style x:Key="PropertyValueStyle" TargetType="FrameworkElement">
      <Setter Property="HorizontalAlignment" Value="Left"/>
      <Setter Property="MinWidth" Value="400"/>
    </Style>

    <!-- Стиль для редактируемых полей -->
    <Style x:Key="EditableFieldStyle" TargetType="TextBox" BasedOn="{StaticResource PropertyValueStyle}">
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="BorderBrush" Value="#FF7F9DB9"/>
      <Setter Property="Padding" Value="2"/>
    </Style>

    <!-- Стиль для отображения распознанного текста -->
    <Style x:Key="RecognitionTextStyle" TargetType="TextBlock">
      <Setter Property="FontFamily" Value="Courier New"/>
      <Setter Property="FontSize" Value="12"/>
      <Setter Property="Foreground" Value="DarkRed"/>
      <Setter Property="Background" Value="#FFF8F8F8"/>
      <Setter Property="Padding" Value="5"/>
      <Setter Property="TextWrapping" Value="Wrap"/>
    </Style>

  </UserControl.Resources>

  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="300"/>
      <ColumnDefinition Width="*"/>
      <ColumnDefinition Width="300"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Заголовки -->
    <TextBlock Grid.Column="0" Grid.Row="0" Text="Сообщение агенту:" Style="{StaticResource PropertyNameStyle}" Grid.ColumnSpan="2"/>
    <TextBlock Grid.Column="1" Grid.Row="0" Text="Воздействие на агента:" Style="{StaticResource PropertyNameStyle}" HorizontalAlignment="Center" Margin="10,0,0,10"/>
    <TextBlock Grid.Column="2" Grid.Row="0" Text="Ответ агента:" Style="{StaticResource PropertyNameStyle}"/>

    <!-- окно сообщений агенту -->
    <TextBox Grid.Column="0" Grid.Row="1" 
             Text="{Binding MessageText}"
             IsEnabled="True"
             Style="{StaticResource EditableFieldStyle}"
             MinWidth="300"
             MinHeight="100"
             VerticalAlignment="Center" Grid.ColumnSpan="2"/>

    <StackPanel Grid.Column="0" Grid.Row="2" Orientation="Horizontal" Margin="10,5,5,0">
      <!-- Чекбокс слева -->
      <CheckBox Content="Авторитарная запись"
            IsChecked="{Binding AuthoritativeMode}"
            ToolTip="Новые фразы сразу записываются в дерево, минуя песочницу"
            Margin="0,5"
            FontWeight="Bold"
            VerticalAlignment="Center"/>

      <!-- Кнопка справа -->
      <Button Content="Отправить" 
          Command="{Binding ApplyInfluenceCommand}"
          Style="{StaticResource ActionButtonStyle}"
          IsEnabled="{Binding IsEditingEnabled}" 
          Height="30" 
          Margin="35,0,0,0"
          HorizontalAlignment="Right" 
          Cursor="Hand"/>
    </StackPanel>

    <!-- Отображение распознанного текста -->
    <StackPanel Grid.Column="0" Grid.Row="3" Orientation="Vertical" Margin="0,0,0,0">
      <TextBlock Text="Распознанный текст:" Style="{StaticResource PropertyNameStyle}" FontSize="12"/>
      <Border BorderBrush="#FFCCCCCC" BorderThickness="1" Background="#FFF8F8F8" Padding="5" Margin="0,2,0,5">
        <TextBlock Text="{Binding RecognitionDisplayText}" 
                   Style="{StaticResource RecognitionTextStyle}"
                   MinHeight="40"
                   ToolTip="xxxxx - нераспознанные слова"/>
      </Border>
    </StackPanel>

    <!-- окно воздействий в два столбца -->
    <Grid Grid.Column="1" Grid.Row="1" Margin="10,0,0,0" Grid.RowSpan="3">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- Первый столбец воздействий -->
      <ItemsControl Grid.Column="0" ItemsSource="{Binding Column1Actions}">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <CheckBox Content="{Binding Name}" 
                 IsChecked="{Binding IsSelected}"
                 IsEnabled="{Binding IsEnabled}"
                 Margin="0,2"
                 ToolTip="{Binding Description}"/>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>

      <!-- Второй столбец воздействий -->
      <ItemsControl Grid.Column="1" ItemsSource="{Binding Column2Actions}" Margin="10,0,0,0">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <CheckBox Content="{Binding Name}" 
                 IsChecked="{Binding IsSelected}"
                 IsEnabled="{Binding IsEnabled}"
                 Margin="0,2"
                 ToolTip="{Binding Description}"/>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </Grid>

    <!-- окно ответа агента -->
    <TextBox Grid.Column="2" Grid.Row="1" 
             Text="{Binding AgentResponse}"
             IsEnabled="False"
             Style="{StaticResource EditableFieldStyle}"
             MinWidth="300"
             MinHeight="100" Grid.RowSpan="3" HorizontalAlignment="Center"/>

  </Grid>
</UserControl>