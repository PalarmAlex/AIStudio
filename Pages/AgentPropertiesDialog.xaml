<Window x:Class="AIStudio.Pages.AgentPropertiesDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Свойства агента" Height="720" Width="620"
        WindowStartupLocation="CenterOwner"
        MinHeight="500" MinWidth="500"
        WindowState="Maximized">
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="Auto"/>
      <ColumnDefinition Width="*"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <Grid x:Name="ClearingOverlay"
          Grid.RowSpan="9"
          Background="#80FFFFFF"
          Visibility="Collapsed"
          Panel.ZIndex="1000">
      <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="15,0,0,15">
        <ProgressBar IsIndeterminate="True" Width="200" Height="20" Margin="0,0,0,10"/>
        <TextBlock Text="Очистка данных при переходе на нижестоящую стадию..." HorizontalAlignment="Center" FontSize="14"/>
      </StackPanel>
    </Grid>

    <!-- Блок 1: Колонка 0 — 4 поля по строкам; Колонки 1–2 — Описание и Доп. пожелания на 4 строки -->
    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Имя агента:" Margin="0,4,0,2"/>
      <TextBox x:Name="TextBoxAgentName" Padding="4,3"
               ToolTip="Уникальное имя агента, используется для идентификации в системе и генерации промптов."
               VerticalContentAlignment="Center"/>
    </StackPanel>
    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Стадия развития:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboStage" Padding="4,3" MinWidth="120"
                ToolTip="Текущая стадия развития агента, определяет доступные возможности и поведение."
                DisplayMemberPath="StageNumber" SelectedValuePath="StageNumber"
                SelectionChanged="ComboStage_SelectionChanged"/>
    </StackPanel>
    <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Особые триггеры:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboSpecialTriggers" Padding="4,3" IsEditable="True"
                ToolTip="Факторы, которые могут вызвать нестабильность или неадекватную реакцию. Важно для ИИ при моделировании поведения."
                LostFocus="ComboEditable_LostFocus"/>
    </StackPanel>
    <StackPanel Grid.Row="3" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Особые табу:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboSpecialTaboos" Padding="4,3" IsEditable="True"
                ToolTip="Действия или ситуации, которых агент избегает даже в хорошем состоянии. Критически важно для избегания неконсистентного поведения."
                LostFocus="ComboEditable_LostFocus"/>
    </StackPanel>

    <DockPanel Grid.Row="0" Grid.RowSpan="4" Grid.Column="1" Margin="6,0,6,8">
      <TextBlock Text="Описание агента:" DockPanel.Dock="Top" Margin="0,4,0,2"/>
      <TextBox x:Name="TextBoxDescription" Padding="4,3" MinHeight="60"
               AcceptsReturn="True" TextWrapping="Wrap"
               VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
               ToolTip="Развернутое описание характера, предыстории и особенностей агента. Будет использовано ИИ для понимания контекста."/>
    </DockPanel>
    <DockPanel Grid.Row="0" Grid.RowSpan="4" Grid.Column="2" Margin="6,0,0,8">
      <TextBlock Text="Дополнительные пожелания:" DockPanel.Dock="Top" Margin="0,4,0,2"/>
      <TextBox x:Name="TextBoxAdditionalWishes" Padding="4,3" MinHeight="60"
               AcceptsReturn="True" TextWrapping="Wrap"
               VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
               ToolTip="Дополнительные замечания, особенности или пожелания по поведению агента, которые нужно учесть при генерации."/>
    </DockPanel>

    <!-- Строка 4: Базовый архетип, Ключевая мотивация, Социальность -->
    <StackPanel Grid.Row="4" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Базовый архетип:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboBaseArchetype" Padding="4,3" IsEditable="True"
                ToolTip="Базовый психологический архетип, определяющий фундаментальные паттерны поведения."
                LostFocus="ComboEditable_LostFocus"/>
    </StackPanel>
    <StackPanel Grid.Row="4" Grid.Column="1" Margin="6,0,6,8">
      <TextBlock Text="Ключевая мотивация:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboKeyMotivation" Padding="4,3" IsEditable="True"
                ToolTip="Главный движущий мотив агента, определяет приоритеты в принятии решений."
                LostFocus="ComboEditable_LostFocus"/>
    </StackPanel>
    <StackPanel Grid.Row="4" Grid.Column="2" Margin="6,0,0,8">
      <TextBlock Text="Социальность:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboSociality" Padding="4,3" IsEditable="True"
                ToolTip="Стиль социального взаимодействия: Одиночка - избегает контактов; Избирательный - выбирает узкий круг; Стайный - комфортно в группе; Зависимый - нуждается в постоянном общении."
                LostFocus="ComboEditable_LostFocus"/>
    </StackPanel>

    <!-- Строка 5: Темперамент активность, Темперамент реактивность, Поведение в стрессе (с кнопкой) -->
    <StackPanel Grid.Row="5" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Темперамент активность:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboTemperamentActivity" Padding="4,3" IsEditable="False"
                ToolTip="Уровень общей активности: Низкая - флегматичность, экономия энергии; Средняя - сбалансированность; Высокая - гиперактивность, постоянное движение."/>
    </StackPanel>
    <StackPanel Grid.Row="5" Grid.Column="1" Margin="6,0,6,8">
      <TextBlock Text="Темперамент реактивность:" Margin="0,4,0,2"/>
      <ComboBox x:Name="ComboTemperamentReactivity" Padding="4,3" IsEditable="False"
                ToolTip="Скорость и интенсивность реакции на внешние стимулы: Низкая - замедленные реакции; Средняя - адекватные; Высокая - мгновенные, импульсивные."/>
    </StackPanel>
    <StackPanel Grid.Row="5" Grid.Column="2" Margin="6,0,0,8">
      <TextBlock Text="Поведение в стрессе:" Margin="0,4,0,2"/>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBox x:Name="TextStressBehavior" Grid.Column="0" IsReadOnly="True" Padding="4,3"
                 ToolTip="Набор возможных реакций на стрессовые ситуации. Может быть выбрано несколько вариантов."
                 Background="#FFF0F0F0"/>
        <Button x:Name="SetStressBehaviorButton" Grid.Column="1" Content="Выбрать..." Margin="8,0,0,0" Padding="8,4" Click="ButtonSelectStressBehavior_Click"/>
      </Grid>
    </StackPanel>

    <!-- Строка 6: Реакции на угрозу, Реакции на поощрение, Реакции на наказание (с кнопками) -->
    <StackPanel Grid.Row="6" Grid.Column="0" Margin="0,0,6,8">
      <TextBlock Text="Реакции на угрозу:" Margin="0,4,0,2"/>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBox x:Name="TextThreatResponse" Grid.Column="0" IsReadOnly="True" Padding="4,3"
                 ToolTip="Первичная, инстинктивная реакция при обнаружении угрозы."
                 Background="#FFF0F0F0"/>
        <Button x:Name="SetThreatResponseButton" Grid.Column="1" Content="Выбрать..." Margin="8,0,0,0" Padding="8,4" Click="ButtonSelectThreatResponse_Click"/>
      </Grid>
    </StackPanel>
    <StackPanel Grid.Row="6" Grid.Column="1" Margin="6,0,6,8">
      <TextBlock Text="Реакции на поощрение:" Margin="0,4,0,2"/>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBox x:Name="TextRewardResponse" Grid.Column="0" IsReadOnly="True" Padding="4,3"
                 ToolTip="Типичная реакция на получение поощрения, ресурса или положительной обратной связи."
                 Background="#FFF0F0F0"/>
        <Button x:Name="SetRewardResponseButton" Grid.Column="1" Content="Выбрать..." Margin="8,0,0,0" Padding="8,4" Click="ButtonSelectRewardResponse_Click"/>
      </Grid>
    </StackPanel>
    <StackPanel Grid.Row="6" Grid.Column="2" Margin="6,0,0,8">
      <TextBlock Text="Реакции на наказание:" Margin="0,4,0,2"/>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBox x:Name="TextPunishmentResponse" Grid.Column="0" IsReadOnly="True" Padding="4,3"
                 ToolTip="Типичная реакция на наказание, порицание или лишение ресурса."
                 Background="#FFF0F0F0"/>
        <Button x:Name="SetPunishmentResponseButton" Grid.Column="1" Content="Выбрать..." Margin="8,0,0,0" Padding="8,4" Click="ButtonSelectPunishmentResponse_Click"/>
      </Grid>
    </StackPanel>

    <!-- Текст вставки для промпта + блок описания параметров -->
    <Grid Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,0,0,8">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" MinWidth="220"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <!-- Блок описания параметров (левый нижний угол) -->
      <Border Grid.Column="0" Margin="0,0,8,0" Padding="8,6" Background="#FFF8F8F8"
              BorderBrush="#FFE0E0E0" BorderThickness="1" CornerRadius="3">
        <StackPanel>
          <TextBlock Text="Параметры для вставки в промпт:" FontWeight="SemiBold" Margin="0,0,0,6"/>
          <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="#FF404040">
            <Run Text="stileCombination" FontWeight="SemiBold"/> — комбинации стилей реагирования<LineBreak/>
            <Run Text="InfluenceActionList" FontWeight="SemiBold"/> — список воздействий с пульта<LineBreak/>
            <Run Text="AdaptiveActionList" FontWeight="SemiBold"/> — список адаптивных действий<LineBreak/>
            <Run Text="ReflexGenStyleCount" FontWeight="SemiBold"/> — количество комбинаций стилей<LineBreak/>
            <Run Text="ReflexGenTriggerCount" FontWeight="SemiBold"/> — количество воздействий<LineBreak/>
            <Run Text="ReflexGenLinesPerState" FontWeight="SemiBold"/> — строк на состояние (этап 2)<LineBreak/>
            <Run Text="ReflexGenLinesThreeStates" FontWeight="SemiBold"/> — строк на три состояния (этап 2)<LineBreak/>
            <Run Text="ReflexGenLinesStage1PerState" FontWeight="SemiBold"/> — строк на состояние (этап 1)<LineBreak/>
            <Run Text="ReflexGenLinesStage1ThreeStates" FontWeight="SemiBold"/> — строк на три состояния (этап 1)
          </TextBlock>
        </StackPanel>
      </Border>
      <StackPanel Grid.Column="1">
        <TextBlock Text="Текст вставки для промпта:" Margin="0,4,0,2"/>
        <TextBox x:Name="TextBoxPromptSuffix" Padding="4,3" Height="220"
                 AcceptsReturn="True" TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                 ToolTip="Текст, добавляемый в конец сохраняемого промпта. Поддерживаются плейсхолдеры в квадратных скобках — см. блок слева."/>
      </StackPanel>
    </Grid>

    <!-- Кнопки -->
    <StackPanel Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
      <Button x:Name="ButtonCreatePrompt" Content="Создать промпт для ИИ" Margin="0,0,10,0" Padding="12,6" Click="ButtonCreatePrompt_Click"/>
      <Button x:Name="ButtonSave" Content="Сохранить" Margin="0,0,10,0" Padding="12,6" IsDefault="True" Click="ButtonSave_Click"/>
      <Button Content="Закрыть" Padding="12,6" IsCancel="True" Click="ButtonClose_Click"/>
    </StackPanel>
  </Grid>
</Window>
