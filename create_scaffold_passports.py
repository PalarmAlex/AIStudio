# -*- coding: utf-8 -*-
"""Создание паспортов на леса ЛСПХ, ЛСПШ, ЛСПК по ГОСТ 27321-2023."""
import os
from docx import Document
from docx.shared import Pt, Cm
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.oxml.ns import qn
from docx.oxml import OxmlElement

def set_cell_shading(cell, color):
    """Заливка ячейки таблицы."""
    shading = OxmlElement('w:shd')
    shading.set(qn('w:fill'), color)
    cell._tc.get_or_add_tcPr().append(shading)

def add_heading_custom(doc, text, level=1):
    p = doc.add_paragraph()
    run = p.add_run(text)
    run.bold = True
    run.font.size = Pt(14 if level == 1 else 12)
    run.font.name = 'Times New Roman'
    p.paragraph_format.space_before = Pt(12)
    p.paragraph_format.space_after = Pt(6)
    return p

def add_paragraph_custom(doc, text, bold=False):
    p = doc.add_paragraph()
    run = p.add_run(text)
    run.bold = bold
    run.font.size = Pt(11)
    run.font.name = 'Times New Roman'
    p.paragraph_format.space_after = Pt(3)
    return p

def add_passport_section(doc, title, rows):
    """Добавить секцию паспорта в виде таблицы."""
    add_heading_custom(doc, title, level=2)
    table = doc.add_table(rows=len(rows), cols=2)
    table.style = 'Table Grid'
    for i, (key, value) in enumerate(rows):
        table.rows[i].cells[0].text = key
        table.rows[i].cells[1].text = str(value)
        for cell in table.rows[i].cells:
            for paragraph in cell.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'Times New Roman'
    doc.add_paragraph()

def main():
    out_dir = r"C:\Users\user_\Desktop\Новая папка"
    try:
        os.makedirs(out_dir, exist_ok=True)
    except Exception:
        out_dir = os.path.expanduser("~") + "\\Desktop"
    out_path = os.path.join(out_dir, "Паспорта_леса_ЛСПХ_ЛСПШ_ЛСПК.docx")

    doc = Document()
    # Стиль по умолчанию
    style = doc.styles['Normal']
    style.font.name = 'Times New Roman'
    style.font.size = Pt(11)

    # Титульный блок
    title = doc.add_paragraph()
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    r = title.add_run("ПАСПОРТА\nна строительные леса стоечные приставные\nтипов ЛСПХ, ЛСПШ, ЛСПК")
    r.bold = True
    r.font.size = Pt(16)
    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    p = doc.add_paragraph("Составлены в соответствии с ГОСТ 27321-2023 «Леса стоечные приставные для строительно-монтажных работ. Технические условия» (введён в действие с 01.02.2024).")
    for run in p.runs:
        run.font.size = Pt(11)
        run.font.name = 'Times New Roman'
    doc.add_paragraph()

    # ========== ОБЩИЕ НОРМАТИВНЫЕ ССЫЛКИ ==========
    add_heading_custom(doc, "1. Нормативные ссылки", level=1)
    refs = [
        "ГОСТ 27321-2023 — Леса стоечные приставные для строительно-монтажных работ. Технические условия.",
        "ГОСТ 3262 — Трубы стальные водогазопроводные. Технические условия.",
        "ГОСТ 10704 — Трубы стальные электросварные прямошовные. Сортамент.",
        "ГОСТ 30245 — Профили стальные гнутые замкнутые сварные квадратные и прямоугольные для строительных конструкций.",
        "ГОСТ 380 — Сталь углеродистая обыкновенного качества. Марки.",
        "ГОСТ 1050 — Металлопродукция из нелегированных конструкционных качественных и специальных сталей.",
        "ГОСТ 8486 — Пиломатериалы хвойных пород. Технические условия.",
        "ГОСТ Р 58752-2019 — Средства подмащивания. Общие технические условия (РФ).",
        "ГОСТ Р 57956-2017/EN 12812:2008 — Стоечные опорные конструкции опалубочных систем и строительных лесов (РФ).",
    ]
    for ref in refs:
        add_paragraph_custom(doc, "• " + ref)
    doc.add_paragraph()

    # ========== МАТЕРИАЛЫ И ТИПОРАЗМЕРЫ ТРУБ (ОБЩИЙ РАЗДЕЛ) ==========
    add_heading_custom(doc, "1.1. Материалы и типоразмеры труб. Частота применения", level=1)
    add_paragraph_custom(doc, "Трубы для элементов лесов применяют по ГОСТ 3262, ГОСТ 10704, ГОСТ 30245 (п. 4.3.2 ГОСТ 27321-2023). Марки сталей — по таблице 2 ГОСТ 27321-2023 (20 по ГОСТ 1050; Ст3пс6, Ст3сп5, Ст3пс5 по ГОСТ 380). Ниже приведены типоразмеры труб, наиболее часто применяемые для лесов ЛСПХ, ЛСПШ, ЛСПК по отраслевой практике и конструкторской документации.")
    tbl_pipes = doc.add_table(rows=8, cols=5)
    tbl_pipes.style = 'Table Grid'
    pipe_headers = ["Типоразмер трубы", "Нормативный документ", "Тип лесов", "Назначение элементов", "Частота применения"]
    for j, h in enumerate(pipe_headers):
        tbl_pipes.rows[0].cells[j].text = h
        set_cell_shading(tbl_pipes.rows[0].cells[j], "E0E0E0")
    pipe_data = [
        ("48×2,0; 48×2,5", "ГОСТ 3262, ГОСТ 10704", "ЛСПХ", "стойки, ригели, связи", "высокая"),
        ("42×2,0; 42×1,5", "ГОСТ 3262, ГОСТ 10704", "ЛСПХ", "связи, ограждения", "средняя"),
        ("48×3,0; 48×3,5", "ГОСТ 3262, ГОСТ 10704", "ЛСПШ", "стойки, ригели", "высокая"),
        ("57×3,5; 57×4,0", "ГОСТ 10704", "ЛСПШ", "стойки (высота > 40 м)", "средняя"),
        ("48×2,5; 48×3,0", "ГОСТ 3262, ГОСТ 10704", "ЛСПК", "стойки, ригели, связи", "высокая"),
        ("42×2,0", "ГОСТ 3262, ГОСТ 10704", "ЛСПК", "связи, диагонали", "средняя"),
        ("Профиль кв./прямоуг.", "ГОСТ 30245", "ЛСПХ, ЛСПК", "ригели, настил (металл.)", "низкая"),
    ]
    for i, row_data in enumerate(pipe_data, start=1):
        for j, val in enumerate(row_data):
            tbl_pipes.rows[i].cells[j].text = val
    for row in tbl_pipes.rows[: len(pipe_data) + 1]:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(9)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()

    # ========== 1.2 ТИПОВЫЕ НАЗВАНИЯ ЭЛЕМЕНТОВ ЛЕСОВ ==========
    add_heading_custom(doc, "1.2. Типовые названия элементов лесов", level=1)
    add_paragraph_custom(doc, "Термины и определения для лесов стоечных приставных установлены разделом 3 ГОСТ 27321-2023. Ниже приведены типовые наименования элементов, используемые в паспортах и инструкциях по эксплуатации (в т.ч. по п. 10 ГОСТ 27321-2023).")
    elem_rows = [
        ("Стойка", "вертикальный несущий элемент; воспринимает нагрузку от ярусов и передаёт её на опору (башмак). Изготавливается из труб по ГОСТ 3262, 10704 (п. 4.3.2 ГОСТ 27321-2023)."),
        ("Ригель", "горизонтальный несущий элемент, соединяющий стойки в одном ярусе; на ригели опирается настил. Термин «ригель» используется в п. 4.3.5, 4.3.12, 4.4.1 ГОСТ 27321-2023."),
        ("Связь (диагональ)", "элемент диагональной раскосы для обеспечения пространственной жёсткости и устойчивости. Установка диагональных связей указывается в паспорте/инструкции (п. 8.8 ГОСТ 27321-2023)."),
        ("Поперечина", "горизонтальный элемент, связывающий леса со стеной здания; часто несёт крепёж (анкер, крюк) для анкеровки лесов к фасаду."),
        ("Башмак (опорная пята)", "конструкция для перераспределения нагрузки от стойки на площадь опирания (п. 3.1 ГОСТ 27321-2023)."),
        ("Башмак-домкрат (винтовая опора)", "башмак с устройством вертикальной регулировки (п. 3.2 ГОСТ 27321-2023)."),
        ("Хомут", "устройство для соединения двух труб (п. 3.5 ГОСТ 27321-2023); применяется в лесах ЛСПХ."),
        ("Настил (площадка)", "горизонтальная поверхность для размещения рабочих и материалов; с защитным ограждением (п. 3.3 ГОСТ 27321-2023)."),
    ]
    t_elem = doc.add_table(rows=len(elem_rows) + 1, cols=2)
    t_elem.style = 'Table Grid'
    t_elem.rows[0].cells[0].text = "Элемент"
    t_elem.rows[0].cells[1].text = "Назначение, нормативная ссылка"
    set_cell_shading(t_elem.rows[0].cells[0], "E0E0E0")
    set_cell_shading(t_elem.rows[0].cells[1], "E0E0E0")
    for i, (k, v) in enumerate(elem_rows, start=1):
        t_elem.rows[i].cells[0].text = k
        t_elem.rows[i].cells[1].text = v
    for row in t_elem.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(9)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()

    # ========== 1.3 ТЕХНИЧЕСКИЕ РЕКОМЕНДАЦИИ ПО РАСПОЛОЖЕНИЮ ЭЛЕМЕНТОВ ==========
    add_heading_custom(doc, "1.3. Технические рекомендации и требования по расположению элементов лесов", level=1)
    add_paragraph_custom(doc, "Ниже приведены требования и рекомендации по ГОСТ 27321-2023, ГОСТ Р 58752-2019 и отраслевой практике. Конкретные схемы установки диагоналей, крепления и соединения секций должны быть указаны в паспорте или инструкции по эксплуатации на конкретный тип лесов (п. 8.2, 8.8 ГОСТ 27321-2023).")
    add_paragraph_custom(doc, "Диагональные связи. Установка диагональных связей должна быть указана в паспорте, инструкции по эксплуатации, проектной или организационно-технологической документации (п. 8.8 ГОСТ 27321-2023). Угол наклона диагонали к горизонтали и количество (на секцию, крест-накрест, с одной или двух сторон) задаются конструкторской документацией изготовителя; при отсутствии в ГОСТ 27321-2023 численных значений угла ориентируются на обеспечение геометрической неизменяемости и расчёт по ГОСТ Р 57956-2017. Диагональ крепят к стойкам и/или к ригелям в узлах, обеспечивающих передачу усилий; крепление только к горизонтальным элементам без связи со стойками не обеспечивает пространственную жёсткость и не допускается. Одна диагональ на несколько секций допустима, если это предусмотрено паспортом/расчётом. На практике часто устанавливают диагонали в каждой секции или через одну, с одной или с двух сторон фасада, в шахматном порядке.")
    add_paragraph_custom(doc, "Соединение секций. Секции соединяют по месту стыкования стоек (внахлёст, муфтой, фланцем — по типу лесов) и связями. Горизонтали (ригели) могут быть общими на смежные секции, если конструкция и паспорт это предусматривают (типово для рамных и штыревых — ригель перекрывает пролёт между стойками).")
    add_paragraph_custom(doc, "Соединение стоек. Стойки наращивают по высоте: труба в трубу (вставка), муфтой с болтами или по типу «штырь в отверстие» (ЛСПШ), клиновым замком (ЛСПК). Выбор способа определяется типом лесов и указывается в инструкции изготовителя.")
    add_paragraph_custom(doc, "Лестницы. Для подъёма и спуска леса оборудуют лестницами по ГОСТ Р 58758-2019. Расстояние между лестницами — не более 40 м (п. 4.3.14 ГОСТ 27321-2023). Леса длиной в пределах 40 м должны иметь не менее двух лестниц. Угол наклона лестниц — не более 75° к горизонтали. Проёмы в настиле для выхода с лестниц ограждают.")
    add_paragraph_custom(doc, "Крепление приставных лесов к зданию. Крепление к зданию (сооружению) выполняют способами и в местах, указанных в паспорте, инструкции, проектной или организационно-технологической документации (п. 8.2 ГОСТ 27321-2023). При отсутствии таких указаний и при отсутствии тента/сетки крепление осуществляют не реже: через один ярус для крайних стоек; через два пролёта для верхнего яруса; одного крепления на каждые 50 м² проекции поверхности лесов на фасад. Устойчивость свободностоящих лесов (без крепления к зданию) обеспечивают подкосами или растяжками. Для свободностоящих лесов без дополнительных элементов жёсткости соблюдают отношение минимальной стороны основания к высоте: в помещении не менее 1:4, на улице не менее 1:3. Леса, установленные замкнутым контуром вокруг опоры/колонны, при расчёте могут рассматриваться как свободностоящие; необходимость анкеровки к самой опоре или к прилегающим конструкциям определяется расчётом и паспортом (при замкнутом контуре жёсткость выше, но при большой высоте и ветровой нагрузке крепление может требоваться).")
    doc.add_paragraph()

    # ========== 1.4 НАСТИЛЫ В ОСОБЫХ УСЛОВИЯХ ==========
    add_heading_custom(doc, "1.4. Требования к настилам в особых условиях. Ограничения на деревянный настил", level=1)
    add_paragraph_custom(doc, "По ГОСТ 27321-2023 деревянные щиты настила изготавливают из досок хвойных пород не ниже 2-го сорта по ГОСТ 8486 с антисептической и огнезащитной пропиткой (п. 4.3.5). Применение деревянного настила ограничивается требованиями пожарной безопасности и санитарными нормами для объектов с повышенной пожарной и химической опасностью.")
    add_paragraph_custom(doc, "В зданиях и помещениях категорий по взрывопожарной и пожарной опасности, где применяются или хранятся легковоспламеняющиеся и горючие вещества (в т.ч. многие химические производства), полы и настилы в зонах с наличием таких веществ должны выполняться из негорючих материалов или материалов группы горючести Г1 по классификации пожарной опасности (нормативы РФ по противопожарным требованиям). В таких случаях деревянный настил на лесах не допускается; применяют металлические решётчатые или сплошные настилы, либо иные негорючие решения по проекту/ППР. На химических заводах дополнительно учитывают стойкость материала настила к агрессивным средам (покрытия, оцинковка, нержавеющая сталь — по заданию). Конкретные указания о недопустимости деревянного настила и замене его металлическим или иным приводятся в проекте производства работ (ППР) и в инструкции по эксплуатации лесов для данного объекта.")
    doc.add_paragraph()

    # ========== 1.5 ТИПОВЫЕ КОМПЛЕКТУЮЩИЕ ==========
    add_heading_custom(doc, "1.5. Типовые комплектующие лесов", level=1)
    add_paragraph_custom(doc, "Типовые комплектующие для лесов ЛСПХ, ЛСПШ, ЛСПК по отраслевой практике и паспортам изготовителей:")
    comp_rows = [
        ("Хомут поворотный", "для соединения труб под углом; применяется в ЛСПХ для криволинейных участков, переходов по высоте и переменного шага."),
        ("Хомут неповоротный (глухой)", "для жёсткого соединения двух труб в одной плоскости; ЛСПХ."),
        ("Башмак (опорная пята)", "нерегулируемая опора под стойку; опирание через подкладку (дерево, бетон, металл, пластик) по п. 4.3.17 ГОСТ 27321-2023."),
        ("Башмак-домкрат (винтовая опора)", "регулируемая опора для выравнивания по высоте (типовой диапазон регулировки 50–400 мм); под трубы Ø42, Ø48 мм."),
        ("Анкер (пробка-анкер, крюк)", "крепление лесов к стене: дюбель + крюк/болт, закладные; тип и шаг по паспорту и п. 8.2 ГОСТ 27321-2023."),
        ("Клиновой замок (ЛСПК)", "фиксатор ригеля/связи в стойке; клин и прорезь в стойке."),
        ("Штырь (ЛСПШ)", "наваренный на ригель; входит в отверстие стойки при сборке."),
        ("Ограждение (перила, промежуточный элемент)", "по п. 4.3.7–4.3.11 ГОСТ 27321-2023; высота не менее по нормам охраны труда, ячейка сетки не более 10 см."),
        ("Настил деревянный (щит)", "по ГОСТ 8486, антисептик и огнезащита (п. 4.3.5 ГОСТ 27321-2023)."),
        ("Настил металлический", "решётка или лист; при требовании негорючести или агрессивной среде (см. п. 1.4)."),
    ]
    t_comp = doc.add_table(rows=len(comp_rows) + 1, cols=2)
    t_comp.style = 'Table Grid'
    t_comp.rows[0].cells[0].text = "Комплектующее"
    t_comp.rows[0].cells[1].text = "Назначение, примечание"
    set_cell_shading(t_comp.rows[0].cells[0], "E0E0E0")
    set_cell_shading(t_comp.rows[0].cells[1], "E0E0E0")
    for i, (k, v) in enumerate(comp_rows, start=1):
        t_comp.rows[i].cells[0].text = k
        t_comp.rows[i].cells[1].text = v
    for row in t_comp.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(9)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()

    # ========== 1.6 РАСКРОЙ ТРУБ ==========
    add_heading_custom(doc, "1.6. Рекомендации по раскрою труб и влияние на типоразмеры лесов", level=1)
    add_paragraph_custom(doc, "Трубы по ГОСТ 3262 и ГОСТ 10704 поставляются мерной, кратной мерной и немерной длины. Типовые длины хлыстов: 6 м и 11–12 м. Рациональный раскрой минимизирует отходы и задаёт типовые длины элементов лесов.")
    cut_headers = ["Длина хлыста, м", "Вариант раскроя (длины заготовок, м)", "Остаток, м", "Обоснование, выгода"]
    cut_data = [
        ("6", "2 + 2 + 2", "0", "нулевой остаток; типовые ригели/связи 2 м; унификация с шагом яруса 2 м."),
        ("6", "1,5 + 1,5 + 1,5 + 1,5", "0", "нулевой остаток; заготовки для связей, ограждений, коротких пролётов."),
        ("6", "3 + 3", "0", "нулевой остаток; длинные ригели/поперечины при шаге 3 м."),
        ("6", "2 + 2 + 1,5", "0,5", "приемлемый остаток 0,5 м на мелкие детали или отход."),
        ("12", "3 + 3 + 3 + 3", "0", "нулевой остаток; секции длиной 3 м по фронту."),
        ("12", "2 + 2 + 2 + 2 + 2 + 2", "0", "максимальное число заготовок 2 м из 12 м хлыста."),
        ("12", "2,5 + 2,5 + 2,5 + 2,5", "2", "остаток 2 м — на стойки или следующую партию раскроя."),
    ]
    t_cut = doc.add_table(rows=len(cut_data) + 1, cols=4)
    t_cut.style = 'Table Grid'
    for j, h in enumerate(cut_headers):
        t_cut.rows[0].cells[j].text = h
        set_cell_shading(t_cut.rows[0].cells[j], "E0E0E0")
    for i, row_data in enumerate(cut_data, start=1):
        for j, val in enumerate(row_data):
            t_cut.rows[i].cells[j].text = val
    for row in t_cut.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(9)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_paragraph_custom(doc, "Выгода: сокращение отходов снижает себестоимость; унификация длин 2 и 3 м упрощает складирование и сборку. Типовые размеры секций по длине (Д) 2,0; 2,5; 3,0 м (см. разделы 2–4) согласованы с указанным раскроем из 6 и 12 м хлыстов.")
    doc.add_paragraph()

    # ========== ЛСПХ ==========
    add_heading_custom(doc, "2. Паспорт лесов ЛСПХ (леса стоечные приставные хомутовые)", level=1)
    add_heading_custom(doc, "2.1. Пример типового обозначения", level=2)
    add_paragraph_custom(doc, "Структура условного обозначения установлена п. 4.2.1 ГОСТ 27321-2023.")
    t_des = doc.add_table(rows=6, cols=2)
    t_des.style = 'Table Grid'
    for i, (k, v) in enumerate([("Обозначение", "ЛСПХ 2000-60 ГОСТ 27321-2023"), ("ЛСПХ", "леса стоечные приставные хомутовые (тип по таблице 1 ГОСТ 27321-2023)"), ("2000", "нормативное значение поверхностной нагрузки, Па (2000 Па = 200 кгс/м²)"), ("60", "максимальная высота лесов, м"), ("ГОСТ 27321-2023", "нормативный документ на технические условия")]):
        t_des.rows[i].cells[0].text = k
        t_des.rows[i].cells[1].text = v
    for row in t_des.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_passport_section(doc, "2.2. Основные параметры и размеры", [
        ("Наименование типа", "Леса стоечные приставные хомутовые (ЛСПХ)"),
        ("Нормативная поверхностная нагрузка", "до 2500 Па (250 кгс/м²)"),
        ("Максимальная высота лесов", "100 м"),
        ("Минимальная ширина яруса (прохода) в свету", "0,6 м"),
        ("Минимальная высота яруса (прохода) в свету", "1,8 м"),
        ("Шаг яруса", "0,5; 1,0; 2,0 м"),
    ])
    add_heading_custom(doc, "2.3. Линейка типовых размеров секций (Ш × В × Д)", level=2)
    add_paragraph_custom(doc, "Типовые размеры секций по ширине, высоте яруса и длине (вдоль фасада) приведены в таблице. Размеры согласованы с минимальными требованиями ГОСТ 27321-2023 и практикой применения.")
    table_sizes = doc.add_table(rows=6, cols=4)
    table_sizes.style = 'Table Grid'
    headers = ["Ширина секции Ш, м", "Высота яруса В, м", "Длина секции Д, м", "Примечание"]
    for j, h in enumerate(headers):
        table_sizes.rows[0].cells[j].text = h
        set_cell_shading(table_sizes.rows[0].cells[j], "E0E0E0")
    data_lsph = [
        ("0,6", "1,8", "2,0", "минимальные по ГОСТ"),
        ("0,6", "2,0", "2,5", ""),
        ("1,0", "1,8", "2,0", ""),
        ("1,0", "2,0", "2,0; 2,5; 3,0", "наиболее распространённые"),
        ("1,25", "2,0", "2,5; 3,0", ""),
    ]
    for i, row_data in enumerate(data_lsph, start=1):
        for j, val in enumerate(row_data):
            table_sizes.rows[i].cells[j].text = val
    for row in table_sizes.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()

    add_heading_custom(doc, "2.4. Материалы и технические требования (ЛСПХ)", level=2)
    add_paragraph_custom(doc, "Трубы: по ГОСТ 3262, ГОСТ 10704, ГОСТ 30245 — без резьбы, прямые, без вмятин и трещин.")
    add_paragraph_custom(doc, "Несущие элементы (стойки, ригели, связи): сталь марок 20 по ГОСТ 1050; Ст3пс6, Ст3сп5 по ГОСТ 380. Хомуты, ограждения: Ст3пс5, Ст3сп5 по ГОСТ 380. Ударная вязкость при −40 °C не менее 3·10⁴ Дж/м² (ГОСТ 9454).")
    add_paragraph_custom(doc, "Климатическое исполнение У с ограничением нижней температуры до −40 °C (ГОСТ 15150).")
    add_paragraph_custom(doc, "Настил: деревянные щиты из досок хвойных пород не ниже 2-го сорта по ГОСТ 8486, с антисептической и огнезащитной пропиткой. См. раздел 5 настоящего документа.")
    add_paragraph_custom(doc, "Масса сборочной единицы при ручной сборке — не более 28 кг. Ограждения — по п. 4.3.7–4.3.11 ГОСТ 27321-2023; высота бортового ограждения настила не менее 0,15 м.")
    doc.add_paragraph()
    add_heading_custom(doc, "2.5. Порядок сборки лесов ЛСПХ", level=2)
    add_paragraph_custom(doc, "1) Подготовка основания: планировка, уплотнение, отвод воды (п. 8.1 ГОСТ 27321-2023). Установка башмаков или башмаков-домкратов с подкладками по п. 4.3.17. 2) Установка стоек первого яруса и их фиксация хомутами. 3) Монтаж ригелей и связей (горизонтальных и диагональных) по схеме из паспорта/инструкции. 4) Установка поперечин и крепление к стене (анкерами) в соответствии с п. 8.2 ГОСТ 27321-2023. 5) Наращивание стоек по высоте (вставка «труба в трубу» или муфтой), повторение ярусов ригелей, связей и креплений. 6) Укладка настилов, монтаж ограждений. 7) Установка лестниц (не реже чем через 40 м, п. 4.3.14). Разборка — в обратном порядке.")
    doc.add_paragraph()

    # ========== ЛСПШ ==========
    add_heading_custom(doc, "3. Паспорт лесов ЛСПШ (леса стоечные приставные штыревые)", level=1)
    add_heading_custom(doc, "3.1. Пример типового обозначения", level=2)
    add_paragraph_custom(doc, "Структура условного обозначения — п. 4.2.1 ГОСТ 27321-2023.")
    t_lspsh = doc.add_table(rows=6, cols=2)
    t_lspsh.style = 'Table Grid'
    for i, (k, v) in enumerate([("Обозначение", "ЛСПШ 2500-40 ГОСТ 27321-2023"), ("ЛСПШ", "леса стоечные приставные штыревые (тип по таблице 1 ГОСТ 27321-2023)"), ("2500", "нормативное значение поверхностной нагрузки, Па (2500 Па = 250 кгс/м²)"), ("40", "максимальная высота лесов, м"), ("ГОСТ 27321-2023", "нормативный документ на технические условия")]):
        t_lspsh.rows[i].cells[0].text = k
        t_lspsh.rows[i].cells[1].text = v
    for row in t_lspsh.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_passport_section(doc, "3.2. Основные параметры и размеры", [
        ("Наименование типа", "Леса стоечные приставные штыревые (ЛСПШ)"),
        ("Нормативная поверхностная нагрузка", "до 5000 Па (500 кгс/м²)"),
        ("Максимальная высота лесов", "80 м"),
        ("Минимальная ширина яруса (прохода) в свету", "2,0 м"),
        ("Минимальная высота яруса (прохода) в свету", "2,0 м (по отраслевой практике)"),
        ("Шаг яруса", "по конструкторской документации (обычно 2,0 м)"),
    ])
    add_heading_custom(doc, "3.3. Линейка типовых размеров секций (Ш × В × Д)", level=2)
    add_paragraph_custom(doc, "Для ЛСПШ минимальная ширина яруса 2,0 м; типовые размеры секций:")
    table_lspsh = doc.add_table(rows=4, cols=4)
    table_lspsh.style = 'Table Grid'
    for j, h in enumerate(headers):
        table_lspsh.rows[0].cells[j].text = h
        set_cell_shading(table_lspsh.rows[0].cells[j], "E0E0E0")
    data_lspsh = [
        ("2,0", "2,0", "2,0", "минимальные по ГОСТ"),
        ("2,0", "2,0", "2,5; 3,0", ""),
        ("2,5", "2,0", "2,5; 3,0", ""),
    ]
    for i, row_data in enumerate(data_lspsh, start=1):
        for j, val in enumerate(row_data):
            table_lspsh.rows[i].cells[j].text = val
    for row in table_lspsh.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_heading_custom(doc, "3.4. Материалы и технические требования (ЛСПШ)", level=2)
    add_paragraph_custom(doc, "Трубы и стали — те же, что для ЛСПХ (раздел 2.4). Настил — деревянные щиты по ГОСТ 8486 не ниже 2-го сорта, антисептирование и огнезащитная пропитка обязательны.")
    doc.add_paragraph()
    add_heading_custom(doc, "3.5. Обоснование минимальной ширины яруса 2,0 м", level=2)
    add_paragraph_custom(doc, "Минимальная ширина яруса (прохода) в свету для лесов ЛСПШ установлена в 2,0 м таблицей 1 ГОСТ 27321-2023. Прямое техническое обоснование в тексте стандарта не приведено; ниже даны формулировки, опирающиеся на нормативные документы и конструктивные особенности типа ЛСПШ.")
    add_paragraph_custom(doc, "1) Нормативное закрепление: значение 2,0 м является обязательным требованием таблицы 1 ГОСТ 27321-2023 для типа ЛСПШ. Для ЛСПХ и ЛСПК в той же таблице указаны меньшие минимальные ширины (0,6 м и 0,5 м соответственно). Применение требований таблицы 1 обязательно при проектировании и эксплуатации лесов по ГОСТ 27321-2023.")
    add_paragraph_custom(doc, "2) Конструктивное ограничение: леса ЛСПШ выполняются с жёстким узловым соединением элементов (ригели крепятся к стойкам посредством наваренных штырей по ГОСТ 27321-2023, п. 3.1 — хомут как устройство для соединения двух труб к штыревым лесам не применяется). Шаг между стойками и, следовательно, ширина яруса задаётся типоразмером ригелей и не регулируется в широких пределах, в отличие от лесов ЛСПХ и ЛСПК (соединения хомутом или клином допускают переменный шаг). Таким образом, возможность обеспечения ширины прохода менее 2,0 м конструкцией ЛСПШ без изменения типоразмера элементов стандартом не предусмотрена.")
    add_paragraph_custom(doc, "3) Нагрузочная способность: по таблице 1 ГОСТ 27321-2023 нормативная поверхностная нагрузка для ЛСПШ — до 5000 Па (500 кгс/м²), что выше, чем для ЛСПХ (до 2500 Па). Требования к прочности и устойчивости при расчёте по ГОСТ Р 57956-2017/EN 12812:2008 приводят к применению более жёстких и, как правило, более крупных модулей каркаса; минимальная ширина 2,0 м согласуется с типовыми пролётами и обеспечением несущей способности.")
    add_paragraph_custom(doc, "Итог: минимальная ширина яруса 2,0 м для ЛСПШ установлена таблицей 1 ГОСТ 27321-2023 и обусловлена конструкцией штыревого соединения (фиксированный шаг), требованиями к несущей способности и применением лесов ЛСПШ при повышенных нагрузках.")
    doc.add_paragraph()
    add_heading_custom(doc, "3.6. Порядок сборки лесов ЛСПШ", level=2)
    add_paragraph_custom(doc, "1) Подготовка основания и установка башмаков (или домкратов) с подкладками. 2) Установка стоек первого яруса; соединение ригелей со стойками посредством штырей (ввод ригеля в отверстие стойки). 3) Монтаж диагональных связей по схеме паспорта. 4) Крепление к стене поперечинами и анкерами по п. 8.2 ГОСТ 27321-2023. 5) Наращивание стоек (стык «труба в трубу» или муфта), повторение ярусов ригелей и связей. 6) Укладка настилов, ограждений. 7) Установка лестниц (не более 40 м между ними). Разборка — в обратном порядке.")
    doc.add_paragraph()

    # ========== ЛСПК ==========
    add_heading_custom(doc, "4. Паспорт лесов ЛСПК (леса стоечные приставные клиновые)", level=1)
    add_heading_custom(doc, "4.1. Пример типового обозначения", level=2)
    add_paragraph_custom(doc, "Структура условного обозначения — п. 4.2.1 ГОСТ 27321-2023.")
    t_lspk = doc.add_table(rows=6, cols=2)
    t_lspk.style = 'Table Grid'
    for i, (k, v) in enumerate([("Обозначение", "ЛСПК 2000-100 ГОСТ 27321-2023"), ("ЛСПК", "леса стоечные приставные клиновые (тип по таблице 1 ГОСТ 27321-2023)"), ("2000", "нормативное значение поверхностной нагрузки, Па (2000 Па = 200 кгс/м²)"), ("100", "максимальная высота лесов, м"), ("ГОСТ 27321-2023", "нормативный документ на технические условия")]):
        t_lspk.rows[i].cells[0].text = k
        t_lspk.rows[i].cells[1].text = v
    for row in t_lspk.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_passport_section(doc, "4.2. Основные параметры и размеры", [
        ("Наименование типа", "Леса стоечные приставные клиновые (ЛСПК)"),
        ("Нормативная поверхностная нагрузка", "до 5000 Па (500 кгс/м²)"),
        ("Максимальная высота лесов", "100 м"),
        ("Минимальная ширина яруса (прохода) в свету", "0,5 м"),
        ("Минимальная высота яруса (прохода) в свету", "по паспорту/инструкции (не менее 1,8 м по практике)"),
        ("Шаг яруса", "0,5; 1,0; 2,0 м"),
    ])
    add_heading_custom(doc, "4.3. Линейка типовых размеров секций (Ш × В × Д)", level=2)
    add_paragraph_custom(doc, "Типовые размеры секций ЛСПК:")
    table_lspk = doc.add_table(rows=6, cols=4)
    table_lspk.style = 'Table Grid'
    for j, h in enumerate(headers):
        table_lspk.rows[0].cells[j].text = h
        set_cell_shading(table_lspk.rows[0].cells[j], "E0E0E0")
    data_lspk = [
        ("0,5", "1,8", "2,0", "минимальные по ГОСТ"),
        ("0,6; 1,0", "1,8; 2,0", "2,0", ""),
        ("1,0", "2,0", "2,5; 3,0", "типовые"),
        ("1,25", "2,0", "2,5; 3,0", ""),
    ]
    for i, row_data in enumerate(data_lspk, start=1):
        for j, val in enumerate(row_data):
            table_lspk.rows[i].cells[j].text = val
    for row in table_lspk.rows:
        for cell in row.cells:
            for p in cell.paragraphs:
                for r in p.runs:
                    r.font.size = Pt(10)
                    r.font.name = 'Times New Roman'
    doc.add_paragraph()
    add_heading_custom(doc, "4.4. Материалы и технические требования (ЛСПК)", level=2)
    add_paragraph_custom(doc, "Трубы и стали — те же, что для ЛСПХ (раздел 2.4). Настил — деревянные щиты по ГОСТ 8486 не ниже 2-го сорта, антисептирование и огнезащитная пропитка.")
    doc.add_paragraph()
    add_heading_custom(doc, "4.5. Порядок сборки лесов ЛСПК", level=2)
    add_paragraph_custom(doc, "1) Подготовка основания, установка башмаков или домкратов с подкладками. 2) Установка стоек первого яруса; монтаж ригелей и связей с фиксацией клиновыми замками (клиновое соединение). 3) Установка диагональных связей по схеме паспорта. 4) Крепление к стене и анкеровка по п. 8.2 ГОСТ 27321-2023. 5) Наращивание стоек и последующих ярусов с клиновой фиксацией. 6) Укладка настилов, ограждений. 7) Установка лестниц (расстояние не более 40 м). Разборка — в обратном порядке; снятие клинов перед демонтажем элементов.")
    doc.add_paragraph()

    # ========== ОБОСНОВАНИЕ ВЫБОРА МАТЕРИАЛОВ ДЛЯ ПОЛОВ (НАСТИЛОВ) ==========
    add_heading_custom(doc, "5. Обоснование выбора материалов для полов (настилов) лесов", level=1)
    add_paragraph_custom(doc, "Согласно ГОСТ 27321-2023 (п. 4.3.5) настил, стойки, башмаки и другие элементы лесов должны выдерживать эксплуатационную нагрузку, соответствующую типу лесов. Для деревянных настилов стандарт прямо устанавливает:")
    add_paragraph_custom(doc, "• Деревянные щиты настила лесов следует изготовлять из досок хвойных пород не ниже 2-го сорта по ГОСТ 8486, подвергнутых антисептической защите.", bold=False)
    add_paragraph_custom(doc, "• Деревянные щиты настила и бортовое ограждение настила лесов должны быть подвергнуты глубокой пропитке огнезащитным составом.", bold=False)
    add_paragraph_custom(doc, "Выбор именно деревянных досок (щитов) обоснован:")
    add_paragraph_custom(doc, "1) Нормативно: ГОСТ 27321-2023 явно предписывает деревянные щиты из хвойных пород; при отсутствии в нём детализации по сортам и размерам досок применяется ГОСТ 8486 «Пиломатериалы хвойных пород. Технические условия» (длина досок от 1,0 до 6,5 м, градация 0,25 м; допуски по размерам и пороки по сортам).")
    add_paragraph_custom(doc, "2) Эксплуатационно: дерево обеспечивает достаточную несущую способность при сосредоточенной нагрузке 1300 Н (130 кгс) на площадку 200×200 мм (п. 4.3.12 ГОСТ 27321-2023), антискользящую поверхность и приемлемую массу щитов.")
    add_paragraph_custom(doc, "3) Безопасность: антисептическая обработка продлевает срок службы и снижает биопоражения; огнезащитная пропитка обязательна по ГОСТ 27321-2023.")
    add_paragraph_custom(doc, "Альтернативы (металлические решётчатые настилы, настилы из ДСП/фанеры и т.п.) в ГОСТ 27321-2023 для основных типов ЛСПХ, ЛСПШ, ЛСПК не предусмотрены; при их применении необходимо руководствоваться конструкторской и эксплуатационной документацией изготовителя и нормами РФ (ГОСТ Р 58752-2019, ГОСТ Р 57956-2017). Для настилов без зазоров (штукатурные, малярные работы над проходами) применяют настил без зазоров (п. 8.4 ГОСТ 27321-2023).")
    doc.add_paragraph()

    # Прочие требования
    add_heading_custom(doc, "6. Прочие технические требования", level=1)
    add_paragraph_custom(doc, "• Срок эксплуатации лесов — не менее 5 лет. Гарантийный срок — 12 мес со дня ввода в эксплуатацию, но не позднее 6 мес со дня поступления потребителю.")
    add_paragraph_custom(doc, "• Лестницы: расстояние между лестницами не более 40 м; леса длиной до 40 м — не менее двух лестниц; угол наклона не более 75° (ГОСТ Р 58758-2019).")
    add_paragraph_custom(doc, "• Молниезащита — по СО 153-34.21.122-2003. Сигнальная окраска — по ГОСТ 12.4.026.")
    add_paragraph_custom(doc, "• Опоры (башмаки, башмаки-домкраты): опирание через деревянную, бетонную, стальную или пластиковую подкладку в соответствии с нагрузкой.")
    add_paragraph_custom(doc, "• Приёмка в эксплуатацию: леса высотой более 4 м — комиссией с оформлением акта; регистрация в журнале учёта средств подмащивания по ГОСТ Р 58752-2019.")
    doc.add_paragraph()
    add_paragraph_custom(doc, "— Конец документа —")

    doc.save(out_path)
    print("Saved:", out_path)
    return out_path

if __name__ == "__main__":
    main()
