<Window x:Class="AIStudio.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AIStudio"       
        xmlns:conv="clr-namespace:AIStudio.Converters"
        mc:Ignorable="d"
        x:Name="mainWindow"
        Title="AI Control Panel" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">

  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Styles/MenuStyles.xaml"/>
      </ResourceDictionary.MergedDictionaries>
      
      <!--конвертеры-->
      <conv:BrightnessToBlurConverter x:Key="BrightnessToBlurConverter"/>
      <conv:BoolToAngleConverter x:Key="BoolToAngleConverter"/>
      <conv:BoolToStyleConverter x:Key="BoolToStyleConverter"/>
      <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
      <conv:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>

      <BitmapImage x:Key="ActivateIcon" UriSource="/Resources/activate.png"/>
      <BitmapImage x:Key="DeactivateIcon" UriSource="/Resources/deactivate.png"/>
      <BitmapImage x:Key="DeleteIcon" UriSource="/Resources/delete.png"/>
      <BitmapImage x:Key="EditIcon" UriSource="/Resources/Modify.png"/>
      <BitmapImage x:Key="AddIcon" UriSource="/Resources/Add.ico"/>

      <Style x:Key="StatusTextStyle" TargetType="TextBlock">
        <Setter Property="Foreground" Value="#FF333335"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
      </Style>

      <Style TargetType="Button" x:Key="PulseButtonStyle">
        <Setter Property="Foreground" Value="{Binding PulseButtonColor}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="Padding" Value="5,0"/>
        <Setter Property="Margin" Value="0,0,10,0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Style.Triggers>
          <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="TextBlock.TextDecorations" Value="Underline"/>
          </Trigger>
        </Style.Triggers>
      </Style>

      <Style x:Key="IconButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="5,0"/>
        <Setter Property="Margin" Value="0,0,10,0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Style.Triggers>
          <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="Background" Value="#FFEEEEEE"/>
          </Trigger>
        </Style.Triggers>
      </Style>

    </ResourceDictionary>
  </Window.Resources>

  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="250"/>
      <ColumnDefinition Width="*"/>
      <!--<ColumnDefinition Width="200"/>-->
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Левое вертикальное меню -->
    <ScrollViewer Grid.Column="0" Grid.RowSpan="3" 
                 VerticalScrollBarVisibility="Auto"
                 HorizontalScrollBarVisibility="Disabled"
                 Padding="0,0,5,0">

      <StackPanel Grid.Column="0" Grid.RowSpan="3" Background="#FFE0E0E0">

        <Expander Header="Агент" Style="{StaticResource MenuExpanderStyle}" IsExpanded="{Binding IsAgentExpanded}">
          <StackPanel>
            <Button Content="Данные Агента" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="33"/>
          </StackPanel>
        </Expander>

        <Expander Header="Гомеостаз" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Адаптивные действия" Margin="20,2,5,2"
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="3"/>            
            
            <Button Content="Стили реагирования" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="2"/>            
            
            <Button Content="Жизненные параметры" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="1"/>

            <Button Content="Сенсорная система" Margin="20,2,5,2"
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="27"/>

            <Button Content="Внешнее воздействие" Margin="20,2,5,2"
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="28"/>
            
          </StackPanel>
        </Expander>

        <Expander Header="Рефлексы" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Безусловные рефлексы" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="4"/>

            <Button Content="Условные рефлексы" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="5"/>

            <Button Content="Дерево триггеров рефлексов" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="6"/>

          </StackPanel>
        </Expander>

        <Expander Header="Автоматизмы" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Таблица Автоматизмов" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="8"/>

            <Button Content="Дерево Автоматизмов" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="9"/>

            <Button Content="Цепочки Автоматизмов" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="10"/>

          </StackPanel>
        </Expander>

        <Expander Header="Психика" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Дерево эпизодической памяти" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="11"/>

            <Button Content="Дерево ситуации" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="12"/>

            <Button Content="Дерево проблем" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="13"/>

            <Button Content="Моторные правила реагирования" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="14"/>

            <Button Content="Ментальные правила реагирования" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="15"/>

            <Button Content="Циклы осмысления" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="16"/>

            <Button Content="Значимость элементов восприятия" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="17"/>

            <Button Content="Доминанты" Margin="20,2,5,2" Style="{StaticResource MenuButtonStyle}"/>
          </StackPanel>
        </Expander>

        <Expander Header="Сознание" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Информационная среда" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="18"/>

          </StackPanel>
        </Expander>

        <Expander Header="Архивация" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Экспортировать настройки" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="19"/>

            <Button Content="Сохранить текущее состояние" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="20"/>

            <Button Content="Сохранить память" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="21"/>

            <Button Content="Архивировать всю память" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="22"/>

            <Button Content="Восстановить память" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="23"/>

            <Button Content="Сбросить память психики" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="24"/>

          </StackPanel>
        </Expander>

        <Expander Header="Настройки" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Общие настройки" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="25"/>

          </StackPanel>
        </Expander>

        <Expander Header="Справка" Style="{StaticResource MenuExpanderStyle}">
          <StackPanel>
            <Button Content="Руководство пользователя" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="26"/>

            <Button Content="Руководство разработчика" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="29"/>

            <Button Content="Теория МВАП" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="30"/>

            <Button Content="Теория проектирования" Margin="20,2,5,2" 
              Style="{StaticResource MenuButtonStyle}"
              Command="{Binding VerticalMenuItemClickedCommand}"
              CommandParameter="31"/>

          </StackPanel>
        </Expander>

      </StackPanel>
    </ScrollViewer>

    <!-- Основное содержимое  -->
    <Border Grid.Column="1" Grid.Row="1" BorderBrush="Gray" BorderThickness="1">
      <ContentControl Content="{Binding CurrentContent}"/>
    </Border>

    <!-- Статусбар -->
    <StatusBar Grid.Column="1" Grid.Row="2" Background="#FFDDDDDD">
      <StatusBar.ItemsPanel>
        <ItemsPanelTemplate>
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
          </Grid>
        </ItemsPanelTemplate>
      </StatusBar.ItemsPanel>

      <!-- Кружок пульсации -->
      <StatusBarItem Grid.Column="0">
        <Ellipse Width="15" Height="15" Margin="10,0,5,0"
         Fill="{Binding PulseIndicatorColor}">
          <Ellipse.Effect>
            <BlurEffect Radius="{Binding PulseBrightness, 
                          Converter={StaticResource BrightnessToBlurConverter}}"/>
          </Ellipse.Effect>
        </Ellipse>
      </StatusBarItem>

      <!-- Кнопка Старт/Стоп -->
      <StatusBarItem Grid.Column="1">
        <Button Content="{Binding PulseButtonText}" 
                Command="{Binding TogglePulseCommand}"
                Foreground="{Binding PulseButtonColor}"
                Background="Transparent"
                BorderThickness="0"
                FontWeight="Bold"
                Padding="5,0"
                Margin="0,0,10,0"/>
      </StatusBarItem>

      <!-- Текст "Пульсов" -->
      <StatusBarItem Grid.Column="2">
        <TextBlock Text="{Binding PulseStatus}" 
                  Style="{StaticResource StatusTextStyle}"
                  FontWeight="SemiBold"
                  Margin="0,0,10,0"/>
      </StatusBarItem>

      <!-- Сбросить время жизни -->
      <StatusBarItem Grid.Column="3">
        <Button Command="{Binding ResetLifeTimeCommand}"
                ToolTip="Сбросить время жизни"
                Style="{StaticResource IconButtonStyle}">
          <Image Source="{StaticResource DeleteIcon}" Width="16" Height="16"/>
        </Button>
      </StatusBarItem>

      <!-- Время жизни -->
      <StatusBarItem Grid.Column="4">
        <TextBlock Text="{Binding LifeTimeStatus}" 
                  Style="{StaticResource StatusTextStyle}"
                  FontWeight="SemiBold"/>
      </StatusBarItem>
    </StatusBar>

  </Grid>
</Window>
